#ğŸ“†2021å¹´ 
ç‹€æ…‹:: #â˜‘DONE 
å®Œæˆæ—¥æœŸ:: 2021-03-26
æ¨™ç±¤:: #ğŸ’»ç·¨ç¨‹/ğŸ›¡è³‡è¨Šå®‰å…¨ #ğŸ’»ç·¨ç¨‹/ğŸŒ Java/99_å…¶ä»– #ğŸ—‚Overview 
å­ç­†è¨˜:: 
æ•™ç¨‹:: 
å‚™è¨»:: 

# å¯†ç¢¼å­¸
- å¯†ç¢¼å­¸æ˜¯ç¶²è·¯å®‰å…¨ã€ä¿¡æ¯å®‰å…¨ã€å€å¡Šéˆâ€¦å­¸ç§‘çš„åŸºç¤
- æ­·å²ï¼š
	- å¤å…¸å¯†ç¢¼å­¸ï¼šæ›¿æ›æ³•ã€ç§»ä½æ³•(å‡±æ’’åŠ å¯†)
		ç ´è§£æ–¹æ³•ï¼šé »ç‡åˆ†ææ³•(å¦‚è‹±æ–‡ä¸­ï¼Œeçš„å‡ºç¾çš„é »ç‡æœ€é«˜)
	- è¿‘ä»£å¯†ç¢¼å­¸ï¼šæ©å°¼æ ¼ç‘ªå¯†ç¢¼æ©Ÿ(æ ¸å¿ƒä¹Ÿæ˜¯ä½¿ç”¨ç§»ä½æ³•ã€æ›¿æ›æ³•)-->è¢«åœ–éˆç ´è§£
	- ç¾ä»£å¯†ç¢¼å­¸ï¼š
		1. æ•£åˆ—å‡½æ•¸(å“ˆå¸Œå‡½æ•¸)ï¼šå¸¸è¦‹åŠ å¯†æ–¹å¼ï¼ŒMD5ã€SHA-1ã€SHA-256
		2. å°ç¨±åŠ å¯†
			- æµåŠ å¯†ï¼š[æµåŠ å¯† -wiki](https://zh.wikipedia.org/wiki/%E6%B5%81%E5%AF%86%E7%A0%81)
			- å¡ŠåŠ å¯†ï¼š[å¡ŠåŠ å¯† -wiki](https://zh.wikipedia.org/zh-tw/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81)
		3. éå°ç¨±åŠ å¯†

## ğŸ”ç›¸é—œçŸ¥è­˜
### bitå’Œbyteçš„å€åˆ¥
- bitï¼Œä½å…ƒï¼ŒäºŒé€²åˆ¶(0æˆ–1)ï¼Œé›»è…¦é‹ç®—åŸºç¤ï¼Œä¸€èˆ¬ä»¥bè¡¨ç¤º
	è³‡æ–™å‚³è¼¸bps(bit per second)ï¼š1Mbps = 1024 Kbps / 8 = 128 KB/s
	```java
    public static void main(final String srg[]){
        final String str = "Hello";
        System.out.println("print bit");
        printBit(str.getBytes());
    }

    private static void printBit(final byte[] bytes) {
        for (final byte b : bytes)
            System.out.println(Integer.toBinaryString(b));
    }
	```
- byteï¼Œå­—ç¯€ã€ä½å…ƒçµ„ï¼Œé›»è…¦æª”æ¡ˆå¤§å°åŸºæœ¬å–®ä½ï¼Œä¸€èˆ¬ä»¥Bè¡¨ç¤º
	1 B = 8 b
	```java
    public static void main(final String srg[]){
        final String str = "Hello";
        System.out.println("print byte");
        printByte(str.getBytes());
    }
	
	private static void printByte(final byte[] bytes) {
        for (final byte b : bytes)
            System.out.println(b);
    }
	```
- ä¸­æ–‡-->byte
	1. UTF-8ï¼Œä¸€å€‹ä¸­æ–‡ = 3 byte
	2. GBKï¼Œä¸€å€‹ä¸­æ–‡ = 2 byte
	```java
    public static void main(final String srg[]) throws UnsupportedEncodingException {
        final String str = "æ¸¬";
        System.out.println("print bit");
        printBit(str.getBytes("GBK"));
        System.out.println("print byte");
        printByte(str.getBytes("GBK"));
    }

    private static void printBit(final byte[] bytes) {
        for (final byte b : bytes)
            System.out.println(Integer.toBinaryString(b));
    }

    private static void printByte(final byte[] bytes) {
        for (final byte b : bytes)
            System.out.println(b);
    }
	```

### base64
- base64ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œæ˜¯å¯è®€æ€§ç®—æ³•(ç‚ºäº†å¯è®€æ€§æ‰è¨ˆç®—)
- base64ç”±64å€‹å­—ç¬¦çµ„æˆï¼Œ`a-z`ã€`A-Z`ã€`0-9`ã€`+`å’Œ`/`
- base58å‰‡ç”±58å€‹å­—ç¬¦çµ„æˆï¼Œä¸€èˆ¬ç”¨åœ¨æ¯”ç‰¹å¹£è£¡çš„ä¸€ç¨®ç·¨ç¢¼æ–¹å¼ï¼Œæ²’æœ‰`0`ã€`o`ã€`I`ã€`i`ã€`+`ã€`/`
- base64åŸç†ï¼šbase64æ˜¯3å€‹å­—ç¯€ç‚ºä¸€çµ„ï¼Œä¸€å…±24ä½å…ƒï¼Œbase64æŠŠä¸‰å€‹å­—ç¯€è½‰æ›ç‚º4çµ„ï¼Œå°‡å€¼æ§åˆ¶åœ¨0~63ä¹‹é–“ï¼Œå¦‚æœä¸å¤ 3å€‹å­—ç¯€å‰‡ä»¥`=`è£œé½Š
	![[å¯†ç¢¼å­¸_01_base64è½‰æ›åŸç†.png]]

### toString()å’Œnew String()å€åˆ¥
```java
public static void main(final String srg[]) throws Exception {
	final String base64 = "01Jk6AecyqldguNoHIO7dw==";// å¯†æ–‡
	final java.util.Base64.Decoder decoder = Base64.getDecoder();
	final byte[] binary = decoder.decode(base64);
	System.out.println("origin str= " + base64);
	System.out.println("new String()= " + new String(binary));
	System.out.println("toString()= " + binary.toString());
}
```
- `toString()`ï¼Œå¯¦éš›ä¸Šèª¿ç”¨Object.toString()ï¼Œè‹¥ç„¡ç‰¹åˆ¥è¦†å¯«å‰‡è¿”å›å“ˆå¸Œå€¼(é¡åœ°å€)
- `new String()`ï¼Œæ ¹æ“šæŒ‡å®šç·¨ç¢¼æ ¼å¼é€²è¡Œè§£ç¢¼ï¼Œè‹¥ç„¡æŒ‡å®šå‰‡ç”¨è™›æ“¬æ©Ÿçš„ç·¨ç¢¼æ ¼å¼ï¼›è‹¥æ˜¯IOS-8859-1å‰‡åˆ°ASCIIæ‰¾ç›¸æ‡‰å­—ç¬¦

## ğŸ”ASCIIç·¨ç¢¼
å­—å…ƒå°æ‡‰è¡¨å¯åƒè€ƒï¼š[ASCII-wiki](https://zh.wikipedia.org/wiki/ASCII)
```java
public static void main(final String args[]) {
	final String str = "hello";
	final char[] charArray = str.toCharArray();
	System.out.println(charArray.hashCode());
	for (final char temp : charArray) {
		System.out.println(temp + "\t " + (int) temp);
	}
}
```

## ğŸ”å‡±æ’’åŠ å¯†
å­—æ¯ç§»ä½
```java
public static void main(final String[] args) {
	// param
	final String origin = "Hello World";
	final int key = -5;
	// encryp
	final String encryp = caesarEncryp(origin, key);
	System.out.println("origin : " + origin);
	System.out.println("encryp(" + key + ") : " + encryp);
	// decryp
	final int decrypKey = getCaesarDecrypLey(encryp);
	final String decryp = caesarEncryp(encryp, decrypKey);
	System.out.println("decryp(" + decrypKey + ") : " + decryp);
}

/**
 * å‡±æ’’åŠ å¯†
 *
 * @param origin æ˜æ–‡
 * @param key å¯†é‘°ï¼Œä½ç§»ä½æ•¸
 * @return åŠ å¯†å¾Œå­—ä¸²
 */
private static String caesarEncryp(final String originStr, final int key) {
	final char[] originChars = new String(originStr).toCharArray();
	final StringBuilder sb = new StringBuilder();
	for (final char c : originChars) {
		sb.append(Character.toString((char) ((int) c + key)));
	}
	return sb.toString();
}

/**
 *  é »ç‡åˆ†æè§£å¯†å¯†é‘°
 * @param encrypStr å¯†æ–‡
 * @return
 */
private static int getCaesarDecrypLey(final String encrypStr) {
	// è¼¸å…¥ç‚ºç©º
	if (encrypStr.length() == 0) {
		return 0;
	}
	// è¨ˆç®—å‡ºç¾é »ç‡æœ€é«˜çš„å­—æ¯
	final char[] encripChar = encrypStr.toLowerCase().toCharArray();
	final Map<Character, Integer> countMap = new HashMap<Character, Integer>();
	for (final char c : encripChar) {
		final Integer before = countMap.get(c);
		countMap.put(c, (before == null || before == 0) ? 1 : before + 1);
	}
	final char maxChar = countMap.entrySet()//
			.stream()//
			.max(Entry.comparingByValue()).get().getKey();
	System.out.println("maxChar=" + maxChar + " ;count=" + countMap.get(maxChar));
	// è¨ˆç®—èˆ‡å­—æ¯eçš„å·®è·
	return (int) 'e' - (int) maxChar;
}
```

## ğŸ”å°ç¨±åŠ å¯† Symmetric Encryption
ä¸€çµ„å¯†é‘°åŒæ™‚ç”¨ä½œåŠ å¯†å’Œè§£å¯†
![[å¯†ç¢¼å­¸_02_å°ç¨±åŠ å¯†.png]]
- ç‰¹é»
	1. åŠ å¯†é€Ÿåº¦å¿«
	2. å¯†æ–‡ä¸å¯é€†
	3. è‹¥åœ¨ç·¨ç¢¼è¡¨ä¸Šæ‰¾ä¸åˆ°å°æ‡‰å­—ç¬¦æœƒå‡ºç¾äº‚ç¢¼
	4. ä¸€èˆ¬éœ€è¦çµåˆbase64ä¸€èµ·ä½¿ç”¨
- class Cipherï¼Œæä¾›åŠ è§£å¯†å¯†ç¢¼çš„åŠŸèƒ½ï¼Œæ§‹æˆJavaåŠ å¯†æ“´å±•(JCE)æ¡†æ¶æ ¸å¿ƒï¼Œåƒè€ƒï¼š[Cipher -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/javax/crypto/Cipher.html)
	`Cipher cipher = Cipher.getInstance("ç®—æ³•/æ¨¡å¼/å¡«å……");`ï¼Œè‹¥ç„¡æŒ‡å®šå‰‡ç‚º`"DES/ECB/PKCS5Padding"`

### åŠ è§£å¯†ç®—æ³•
- DES(Data Encryption Standard)ï¼Œæ•¸æ“šåŠ å¯†æ¨™æº–ï¼Œæ˜¯ä¸€ç¨®ä½¿ç”¨å¯†é‘°åŠ å¯†çš„å¡Šç®—æ³•
	```java
    public static void main(final String srg[]) throws Exception {
        final String input = "Hello World";// æ˜æ–‡
        final String key = "12345678";// å¯†é‘°ï¼ŒDESå¿…é ˆç‚º8å€‹å­—ç¯€ï¼ŒAESå¿…é ˆç‚º16å­—ç¯€
        final String algrithm = "DES";// åŠ å¯†ç®—æ³•
        final String transformation = algrithm + "/ECB/PKCS5Padding";// åŠ å¯†é¡å‹
        final String encrypt = desEncrypt(input, key, transformation, algrithm);
        System.out.println("EDS Encrypt= " + encrypt);
        final String decrypt = desDecrypt(encrypt, key, transformation, algrithm);
        System.out.println("EDS Decrypt= " + decrypt);
    }

    /**
     * ä½¿ç”¨DESæ–¹å¼åŠ å¯†
     *
     * @param input æ˜æ–‡
     * @param key å¯†é‘°
     * @param transformation åŠ å¯†é¡å‹
     * @param algrithm ç®—æ³•
     * @return å¯†æ–‡
     * @throws Exception
     */
    private static String desEncrypt(final String input, final String key, final String transformation,
            final String algrithm) throws Exception {
        final SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algrithm);// åŠ å¯†è¦å‰‡
        final Cipher cipher = Cipher.getInstance(transformation);// åŠ è§£å¯†å°è±¡
        cipher.init(Cipher.ENCRYPT_MODE, sks);
        final byte[] outputBytes = cipher.doFinal(input.getBytes());//åŠ è§£å¯†æ“ä½œ
        // åœ¨ç·¨ç¢¼è¡¨æ‰¾ä¸åˆ°å°æ‡‰çš„å­—ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥æ‰“å°æœƒå‡ºç¾äº‚ç¢¼
        //        System.out.println(new String(outputBytes));

        // binary-->base64
        final Encoder encoder = Base64.getEncoder();
        return encoder.encodeToString(outputBytes);
    }

    /**
     * ä½¿ç”¨DESæ–¹å¼è§£å¯†
     *
     * @param input base64å¯†æ–‡
     * @param key å¯†é‘°
     * @param transformation åŠ å¯†é¡å‹
     * @param algrithm ç®—æ³•
     * @return æ˜æ–‡
     * @throws Exception
     */
    private static String desDecrypt(final String input, final String key, final String transformation,
            final String algrithm) throws Exception {
        // base64-->binary
        final java.util.Base64.Decoder decoder = Base64.getDecoder();
        final byte[] encodeBytes = decoder.decode(input);
        final SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algrithm);// åŠ å¯†è¦å‰‡
        final Cipher cipher = Cipher.getInstance(transformation);// åŠ è§£å¯†å°è±¡
        cipher.init(Cipher.DECRYPT_MODE, sks);
        final byte[] outputBytes = cipher.doFinal(encodeBytes);//åŠ è§£å¯†æ“ä½œ
        return new String(outputBytes);
    }
	```
-  AES(Advanced Encryption Standard)ï¼Œé‡‡ç”¨å¡Šå£å¯†ç®—æ³•ï¼Œç”¨ä¾†æ›¿ä»£DES
	åšæ³•å’ŒDESä¸€æ¨£ï¼Œåªæ˜¯ä¿®æ”¹åŠ å¯†é¡å‹ï¼Œè€Œä¸”å¯†é‘°å¿…é ˆç‚º16å€‹å­—ç¯€

### åŠ å¯†æ¨¡å¼
åƒè€ƒï¼š[åˆ†çµ„å¯†ç¢¼å·¥ä½œæ¨¡å¼ -wiki](https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F)

- ECB(Electronic Codebook)ï¼šé›»å­å¯†ç¢¼æœ¬ï¼Œæ˜æ–‡åˆ†å¡Šå¾Œä½¿ç”¨==åŒä¸€çµ„å¯†é‘°==ç¨ç«‹åŠ å¯†
	![[å¯†ç¢¼å­¸_03_ECBåŠ å¯†.png]]
	1. ç‰¹é»ï¼šåŒæ™‚åŠ å¯†ï¼Œä¸€æ¨£çš„åŸæ–‡æœƒåŠ å¯†å‡ºä¸€æ¨£çš„å¯†æ–‡
	2. å„ªé»ï¼šå¯å¹¶è¡Œè™•ç†æ•¸æ“šï¼ŒåŠ è§£å¯†é€Ÿåº¦å¿«
	3. ç¼ºé»ï¼šä¸èƒ½å¾ˆå¥½çš„ä¿è­·æ•¸æ“š
- CBC(Cipher-block Chaining)ï¼šå¯†ç¢¼å¡Šé€£æ¥ï¼Œæ˜æ–‡åˆ†å¡Šå¾Œèˆ‡å‰ä¸€å€‹å¯†æ–‡å¡Šé€²è¡Œç•°æˆ–å¾Œï¼Œå†é€²è¡ŒåŠ å¯†ã€‚æ¯å€‹å¯†æ–‡å¡Šéƒ½ä¾è³´æ–¼å®ƒå‰é¢æ‰€æœ‰çš„æ˜æ–‡å¡Š
	![[å¯†ç¢¼å­¸_04_CBCåŠ å¯†.png]]
	1. å„ªé»ï¼šåŒæ¨£çš„åŸæ–‡ç”Ÿæˆçš„å¯†æ–‡ä¸ä¸€æ¨£
	2. ç¼ºé»ï¼šä¸²è¡Œè™•ç†æ•¸æ“šï¼ŒåŠ è§£å¯†é€Ÿè®Šå¿«
	3. æ³¨æ„ï¼Œä½¿ç”¨éœ€è¦å¦å¤–æ–°å¢IVåƒæ•¸
		```java
		/**
		 * ä½¿ç”¨DESæ–¹å¼åŠ å¯†ï¼ŒCBCåŠ å¯†æ¨¡å¼
		 *
		 * @param input æ˜æ–‡
		 * @param key å¯†é‘°
		 * @return å¯†æ–‡
		 * @throws Exception
		 */
		private static String desEncrypt(final String input, final String key) throws Exception {
			final IvParameterSpec iv = new IvParameterSpec("12345678".getBytes());// ivå‘é‡
			final SecretKeySpec sks = new SecretKeySpec(key.getBytes(), "DES");// åŠ å¯†è¦å‰‡
			final Cipher cipher = Cipher.getInstance("DES/CBC/PKCS5Padding");// åŠ è§£å¯†å°è±¡
			cipher.init(Cipher.ENCRYPT_MODE, sks, iv);
			final byte[] outputBytes = cipher.doFinal(input.getBytes());//åŠ è§£å¯†æ“ä½œ
			final Encoder encoder = Base64.getEncoder();
			return encoder.encodeToString(outputBytes);
		}
		```

### å¡«å……æ¨¡å¼
ç•¶éœ€è¦æŒ‰å¡Šè™•ç†çš„æ•¸æ“šï¼Œæ•¸æ“šé•·åº¦ä¸ç¬¦åˆå¡Šè™•ç†éœ€æ±‚æ™‚ï¼ŒæŒ‰ç…§æŒ‡å®šæ–¹æ³•ä¾†å¡«å……å¡Šçš„è¦å‰‡
- NoPaddingï¼Œä¸å¡«å……
	1. åœ¨DESåŠ å¯†ä¸‹ï¼ŒåŸæ–‡é•·åº¦å¿…é ˆæ˜¯8bçš„æ•´æ•¸å€
	2. åœ¨AESåŠ å¯†ä¸‹ï¼ŒåŸæ–‡é•·åº¦å¿…é ˆæ˜¯16bçš„æ•´æ•¸å€
- PKCS5Paddingï¼Œè£œè¶³æ•¸æ“šå¡Šä½æ•¸

## ğŸ”æ¶ˆæ¯æ‘˜è¦ç®—æ³• Message Digest
ä¹Ÿç¨±æ•£åˆ—å‡½æ•¸ã€é›œæ¹Šæ¼”å‡½æ•¸(Hash function)
- å°‡é•·åº¦ä¸å›ºå®šçš„ä¿¡æ¯(æˆ–ç¨±æ¶ˆæ¯)ä½œç‚ºè¼¸å…¥åƒæ•¸ï¼Œè¼¸å‡ºå›ºå®šé•·åº¦çš„Hashå€¼
- ç‚ºäº†ä¿è­‰è¼¸å…¥å€¼ï¼Œä½¿ç”¨æ¶ˆæ¯æ‘˜è¦è¨ˆç®—å‡ºçš„å€¼ä¸å¯ä»¥ç¯¡æ”¹
- ç‰¹æ€§ï¼š
	1. è¨ˆç®—çš„è³‡æ–™ä¾†æºç„¡é•·åº¦é™åˆ¶
	2. é›œæ¹Šå€¼é•·åº¦æ°¸é å›ºå®š
	3. é›œæ¹Šæ¼”ç®—æ³•ç‚ºå–®å‘é‹ç®—
	4. ä¸åŒè³‡æ–™ä¾†æºä¸æœƒç”£å‡ºç›¸åŒçš„é›œæ¹Šå€¼
- [åœ¨ç·šé›œæ¹Šç”£ç”Ÿå™¨](https://tool.puckwang.com/tools/hash/)ï¼Œæ³¨æ„ï¼Œè¼¸å‡ºç‚º16é€²åˆ¶çš„å­—ä¸²

### Linuxä¸­é€²è¡Œé›œæ¹Š
1. MD5ï¼Œå·²ç ´è§£
	```console
	[mickey@localhost ~]$ echo "hello"|openssl md5
	(stdin)= b1946ac92492d2347c6235b4d2611184
	```
1. SHA(Secure Hash Algorithm)å®‰å…¨æ•£åˆ—ç®—æ³•
2. SHA1ï¼Œå·²ç ´è§£
	```console
	[mickey@localhost ~]$ echo "hello"|openssl sha1
	(stdin)= f572d396fae9206628714fb2ce00f72e94f2258f
	```
1. SHA224
	```console
	[mickey@localhost ~]$ echo "hello"|openssl sha224
	(stdin)= 2d6d67d91d0badcdd06cbbba1fe11538a68a37ec9c2e26457ceff12b
	```
1. SHA256
	```console
	[mickey@localhost ~]$ echo "hello"|openssl sha256
	(stdin)= 5891b5b522d5df086d0ff0b110fbd9d21bb4fc7163af34d08286a2e846f6be03
	```
1. SHA384
	```console
	[mickey@localhost ~]$ echo "hello"|openssl sha384
	(stdin)= 1d0f284efe3edea4b9ca3bd514fa134b17eae361ccc7a1eefeff801b9bd6604e01f21f6bf249ef030599f0c218f2ba8c
	```
1. SHA512
	```console
	[mickey@localhost ~]$ echo "hello"|openssl sha512
	(stdin)= e7c22b994c59d9cf2b48e549b1e24666636045930d3da7c1acb299d1c3b7f931f94aae41edda2c2b207a36e10f8bcb8d45223e54878f5b316e7ce3b6bc019629
	```

### Java8ä¸­é€²è¡Œé›œæ¹Š
[MessageDigest -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/MessageDigest.html)
é¡å‹ï¼šMD5ã€SHA-1ã€SHA-224ã€SHA-256ã€SHA-384ã€SHA-512
```java
public static void main(final String[] args) throws Exception {
	final String input = "Hello World";// åŸæ–‡
	final String type = "SHA";// é›œæ¹Šç®—æ³•é¡å‹
	final MessageDigest md = MessageDigest.getInstance(type);
	final byte[] outputBinary = md.digest(input.getBytes());
	// å°‡è¼¸å‡ºbinaryè½‰ç‚ºBase64
	final String outputBase64 = Base64.getEncoder().encodeToString(outputBinary);
	// å°‡è¼¸å‡ºbinaryè½‰ç‚º16é€²åˆ¶
	final StringBuilder sb = new StringBuilder();
	for (final byte b : outputBinary) {
		final String hex = Integer.toHexString(b & 0xff);
		sb.append(hex.length() == 1 ? "0" + hex : hex);// è£œé½Šè‡³å…©ä½
	}
	System.out.println(String.format("original= %s;%s_base64= %s;%s_16= %s", input, type, outputBase64, type, sb));
}
```

## ğŸ”éå°ç¨±åŠ å¯† Asymmetric Encryption
![[å¯†ç¢¼å­¸_05_éå°ç¨±åŠ å¯†.png]]

- æ’å°ç¨±åŠ å¯†å°‡é‡‘é‘°åˆ†ç‚ºå…¬é‘°åŠç§é‘°ï¼Œå…¬é‘°å¯ç™¼å¸ƒæ–¼ç¶²ä¸Šï¼Œç§é‘°å‰‡ç”¨æˆ¶è‡ªè¡Œä¿ç®¡ï¼Œå› æ­¤æœƒå‡ºç¾ä»¥ä¸‹å››ç¨®åŠ è§£å¯†æƒ…æ³ï¼š
	1. å…¬é‘°åŠ å¯†ï¼Œå…¬é‘°è§£å¯†-->æ­¤æ–¹æ³•ç„¡æ„ç¾©ï¼Œç›¸ç•¶æ–¼ç„¡åŠ å¯†
	2. å…¬é‘°åŠ å¯†ï¼Œç§é‘°è§£å¯†
	3. ç§é‘°åŠ å¯†ï¼Œå…¬é‘°è§£å¯†
	4. ç§é‘°åŠ å¯†ï¼Œç§é‘°è§£å¯†
- Javaç›¸é—œé¡
	1. [KeyPairGenerator -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/KeyPairGenerator.html)ï¼Œå¯†é‘°å°ç”Ÿæˆå™¨
	1. [KeyPair -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html)ï¼Œå¯†é‘°å°
	1. [PublicKey -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/PublicKey.html "interface in java.security")
	2. [PrivateKey -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/PrivateKey.html "interface in java.security")
	3. [KeyFactory -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/KeyFactory.html)ï¼Œbinery-->PublicKey/PrivateKey
	4. [PKCS8EncodedKeySpec -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/spec/PKCS8EncodedKeySpec.html)ï¼Œç§é‘°è¦èŒƒ
- ç¨‹å¼åƒè€ƒï¼š
	1. [JavaåŠ å¯†èˆ‡è§£å¯†ç­†è¨˜(ä¸‰) éå°ç¨±åŠ å¯†](https://www.itread01.com/content/1508482697.html)

### RSA
[RSAåŠ å¯† -wiki](https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95)

```java
public static void main(final String[] args) throws Exception {
	final String algorithm = "RSA";// å¯†é‘°å°ç”Ÿæˆæ–¹å¼
	final String input = "Hello World";//æ˜æ–‡
	System.out.println("origin= " + input);

	// ! ç¬¬ä¸€æ­¥ï¼Œå–å¾—å…¬é‘°å’Œç§é‘°
	genKey(algorithm);

	// ! ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨å…¬é‘°æˆ–ç§é‘°åŠ å¯†
	final String ecryptStr = doEcrypt(algorithm, getKeyFromFile(algorithm, "D:\\private.pri"), input);
	System.out.println("ecrypt= " + ecryptStr);

	// ! ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨å…¬é‘°æˆ–ç§é‘°è§£å¯†
	final String decrypt = doDecrypt(algorithm, getKeyFromFile(algorithm, "D:\\public.pub"), ecryptStr);
	System.out.println("decrypt= " + decrypt);
}

/**
 * å–å¾—å…¬é‘°å’Œç§é‘°
 *
 * @param algorithm å¯†é‘°å°ç”Ÿæˆæ–¹å¼
 * @return å…¬ç§é‘°
 * @throws Exception
 */
private static void genKey(final String algorithm) throws Exception {
	// å¯†é‘°å°ç”Ÿæˆå™¨
	final KeyPairGenerator kpg = KeyPairGenerator.getInstance(algorithm);
	// ç”Ÿæˆå¯†é‘°å°
	final KeyPair kp = kpg.generateKeyPair();
	// æœ€å¾Œçµæœè½‰ç‚ºbase64å­˜æˆæ–‡æª”
	saveKeyFile(kp.getPublic(), kp.getPrivate(), "D:\\public.pub", "D:\\private.pri");
}

/**
 * å„²å­˜å…¬ç§é‘°æ–‡æª”
 *
 * @param keyMap
 * @param publicKeyPath å…¬é‘°æ–‡æª”è·¯å¾‘
 * @param privateKeyPath ç§é‘°æ–‡æª”è·¯å¾‘
 * @throws Exception
 */
private static void saveKeyFile(final PublicKey publicKey, final PrivateKey privateKey, final String publicKeyPath,
		final String privateKeyPath) throws Exception {
	final String encoding = "UTF-8";
	final Encoder encoder = Base64.getEncoder();
	FileUtils.write(new File(publicKeyPath), encoder.encodeToString(publicKey.getEncoded()), encoding);
	FileUtils.write(new File(privateKeyPath), encoder.encodeToString(privateKey.getEncoded()), encoding);
}

/**
 * ä½¿ç”¨å…¬é‘°æˆ–ç§é‘°åŠ å¯†
 *
 * @param algorithm åŠ å¯†æ–¹å¼
 * @param isPuclic å¯†é‘°æ˜¯å¦ç‚ºå…¬é‘°
 * @param keyFilePath å¯†é‘°æ–‡æª”è·¯å¾‘
 * @param input æ˜æ–‡
 * @return å¯†æ–‡
 * @throws Exception
 */
private static String doEcrypt(final String algorithm, final Key key, final String input) throws Exception {
	final Cipher cipher = Cipher.getInstance(algorithm);
	cipher.init(Cipher.ENCRYPT_MODE, key);
	final byte[] outputBinary = cipher.doFinal(input.getBytes());
	return Base64.getEncoder().encodeToString(outputBinary);
}

/**
 * ä½¿ç”¨å…¬é‘°æˆ–ç§é‘°è§£å¯†
 *
 * @param algorithm åŠ å¯†æ–¹å¼
 * @param key å…¬é‘°æˆ–ç§é‘°
 * @param ecryptStr å¯†æ–‡
 * @return æ˜æ–‡
 * @throws Exception
 */
private static String doDecrypt(final String algorithm, final Key key, final String ecryptStr) throws Exception {
	final byte[] decode = Base64.getDecoder().decode(ecryptStr);
	final Cipher cipher = Cipher.getInstance(algorithm);
	cipher.init(Cipher.DECRYPT_MODE, key);
	return new String(cipher.doFinal(decode));
}

/**
 * å¾æª”æ¡ˆå–å¾—å…¬é‘°æˆ–ç§é‘°
 *
 * @param algorithm åŠ å¯†æ–¹å¼
 * @param keyFilePath å…¬é‘°æˆ–ç§é‘°è·¯å¾‘
 * @return å…¬é‘°æˆ–ç§é‘°
 * @throws Exception
 */
private static Key getKeyFromFile(final String algorithm, final String keyFilePath) throws Exception {
	final String encoding = "UTF-8";
	// file --> String --> binery
	final String keyString = FileUtils.readFileToString(new File(keyFilePath), encoding);
	final byte[] keyBinery = Base64.getDecoder().decode(keyString);
	// binery --> PublicKey/PrivateKey
	final KeyFactory kf = KeyFactory.getInstance(algorithm);
	Key key = null;// å¯†é‘°
	if (keyFilePath.endsWith(".pub")) {// åˆ¤æ–·å…¬é‘°æˆ–ç§é‘°
		final X509EncodedKeySpec keySpec = new X509EncodedKeySpec(keyBinery);// å»ºç«‹å…¬é‘°è¦å‰‡
		key = kf.generatePublic(keySpec);
	} else {
		final PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(keyBinery);// å»ºç«‹ç§é‘°è¦å‰‡
		key = kf.generatePrivate(keySpec);
	}
	return key;
}
```

### ECC
`TODO`

### æ•¸å­—ç°½å
- å®šç¾©ï¼šå…¬é‘°æ•¸å­—ç°½åï¼Œåªæœ‰ä¿¡æ¯çš„ç™¼é€è€…æ‰èƒ½ç”£ç”Ÿåˆ¥äººç„¡æ³•å½é€ çš„ä¸€æ®µæ•¸å­—çš„å­—ä¸²ã€‚é¡ä¼¼æ–¼ç´™æœ¬ç°½å
- åŸºæœ¬åŸç†ï¼š
	![[å¯†ç¢¼å­¸_06_æ•¸å­—ç°½åæµç¨‹.png]]
	1. ç™¼é€è€…å°‡æ–‡ä»¶é€²è¡Œé›œæ¹Šä»¥å–å¾—ä¿¡æ¯æ‘˜è¦(æ•¸å­—ç°½å)ï¼Œå¹¶å°‡æ‘˜è¦é™„åœ¨ä¸Šæ–‡ä»¶ä¸Š
	2. ç™¼é€è€…å°‡å¸¶æ‘˜è¦çš„æ–‡ä»¶ç”¨ç§é‘°åŠ å¯†ï¼Œå¹¶ç™¼é€
	3. æ¥æ”¶è€…ç”¨å…¬é‘°è§£å¯†å–å¾—å¸¶æ‘˜è¦çš„æ–‡ä»¶
	4. æ¥æ”¶è€…å°æ–‡ä»¶é€²è¡Œé›œæ¹Šä»¥å–å¾—çš„ä¿¡æ¯æ‘˜è¦å’Œé™„åœ¨æ–‡ä»¶ä¸Šçš„æ‘˜è¦æ¯”å°ï¼Œè‹¥ä¸€è‡´ä»£è¡¨æ­¤æ–‡ä»¶æœªè¢«ä¿®æ”¹
- Javaç›¸é—œé¡
	1. [Signature -Java8å®˜æ–¹æ–‡ä»¶](https://docs.oracle.com/javase/8/docs/api/java/security/Signature.html)

```java
public static void main(final String[] args) throws Exception {
	final String algorithm = "RSA";// å¯†é‘°å°ç”Ÿæˆæ–¹å¼
	final String algorithmForSign = "SHA1with" + algorithm;
	final String input = "Hello World";//æ˜æ–‡
	System.out.println("origin= " + input);

	// ! ç¬¬ä¸€æ­¥ï¼Œå–å¾—å…¬é‘°
	genKey(algorithm);

	// ! ç¬¬äºŒæ­¥ï¼Œä½¿ç”¨ç§é‘°ç”£ç”Ÿæ•¸å­—ç°½å
	final String signStr = doSign(algorithm, algorithmForSign, input, "D:\\private.pri");
	System.out.println("signStr= " + signStr);

	// ! ç¬¬ä¸‰æ­¥ï¼Œå°‡ç°½åå’Œæ˜æ–‡æ‰“åŒ…å¹¶ç”¨å¯†é‘°åŠ å¯†(ä¸€èˆ¬éå°ç¨±åŠ å¯†ï¼Œæ•…å…ˆçœç•¥)
	final String decyptStr = signStr + "_" + input;

	// ! ç¬¬å››æ­¥ï¼Œä½¿ç”¨å…¬é‘°é©—è­‰æ•¸å­—ç°½å
	final boolean verifyResult = doVerifySign(algorithm, algorithmForSign, decyptStr, "D:\\public.pub");
	System.out.println("verifyResult= " + verifyResult);
}

private static boolean doVerifySign(final String algorithm, final String algorithmForSign, final String decyptStr,
		final String publicKeyPath) throws Exception {
	// transfer signStr to binary
	final String[] strs = decyptStr.split("_");
	final byte[] signBinary = Base64.getDecoder().decode(strs[0]);

	// get message binary for compare
	final byte[] messageBinary = strs[1].getBytes();
	// get public key
	final Key key = getKeyFromFile(algorithm, publicKeyPath);

	// do verify
	final Signature signature = Signature.getInstance(algorithmForSign);
	signature.initVerify((PublicKey) key);
	signature.update(messageBinary);
	return signature.verify(signBinary);
}

/**
 * å–å¾—å…¬é‘°å’Œç§é‘°
 *
 * @param algorithm å¯†é‘°å°ç”Ÿæˆæ–¹å¼
 * @return å…¬ç§é‘°
 * @throws Exception
 */
private static void genKey(final String algorithm) throws Exception {
	// å¯†é‘°å°ç”Ÿæˆå™¨
	final KeyPairGenerator kpg = KeyPairGenerator.getInstance(algorithm);
	// ç”Ÿæˆå¯†é‘°å°
	final KeyPair kp = kpg.generateKeyPair();
	// æœ€å¾Œçµæœè½‰ç‚ºbase64å­˜æˆæ–‡æª”
	saveKeyFile(kp.getPublic(), kp.getPrivate(), "D:\\public.pub", "D:\\private.pri");
}

/**
 * å„²å­˜å…¬ç§é‘°æ–‡æª”
 *
 * @param keyMap
 * @param publicKeyPath å…¬é‘°æ–‡æª”è·¯å¾‘
 * @param privateKeyPath ç§é‘°æ–‡æª”è·¯å¾‘
 * @throws Exception
 */
private static void saveKeyFile(final PublicKey publicKey, final PrivateKey privateKey, final String publicKeyPath,
		final String privateKeyPath) throws Exception {
	final String encoding = "UTF-8";
	final Encoder encoder = Base64.getEncoder();
	FileUtils.write(new File(publicKeyPath), encoder.encodeToString(publicKey.getEncoded()), encoding);
	FileUtils.write(new File(privateKeyPath), encoder.encodeToString(privateKey.getEncoded()), encoding);
}

/**
 * ä½¿ç”¨ç§é‘°ç”£ç”Ÿæ•¸å­—ç°½å
 *
 * @param algorithm å¯†é‘°å°ç”Ÿæˆæ–¹å¼
 * @param algorithmForSign ç°½åç”Ÿæˆæ–¹å¼
 * @param input æ˜æ–‡
 * @param privateKeyPath å¯†é‘°è·¯å¾‘
 * @return é›»å­ç°½å
 * @throws Exception
 */
private static String doSign(final String algorithm, final String algorithmForSign, final String input,
		final String privateKeyPath) throws Exception {
	// get public key or private key
	final Key key = getKeyFromFile(algorithm, privateKeyPath);
	// do sign
	final Signature signature = Signature.getInstance(algorithmForSign);
	if (privateKeyPath.endsWith(".pub")) {
		System.out.println("please use private key");
	} else {
		signature.initSign((PrivateKey) key);
	}
	signature.update(input.getBytes());
	return Base64.getEncoder().encodeToString(signature.sign());
}

/**
 * å¾æª”æ¡ˆå–å¾—å…¬é‘°æˆ–ç§é‘°
 *
 * @param algorithm åŠ å¯†æ–¹å¼
 * @param keyFilePath å…¬é‘°æˆ–ç§é‘°è·¯å¾‘
 * @return å…¬é‘°æˆ–ç§é‘°
 * @throws Exception
 */
private static Key getKeyFromFile(final String algorithm, final String keyFilePath) throws Exception {
	final String encoding = "UTF-8";
	// file --> String --> binery
	final String keyString = FileUtils.readFileToString(new File(keyFilePath), encoding);
	final byte[] keyBinery = Base64.getDecoder().decode(keyString);
	// binery --> PublicKey/PrivateKey
	final KeyFactory kf = KeyFactory.getInstance(algorithm);
	Key key = null;// å¯†é‘°
	if (keyFilePath.endsWith(".pub")) {// åˆ¤æ–·å…¬é‘°æˆ–ç§é‘°
		final X509EncodedKeySpec keySpec = new X509EncodedKeySpec(keyBinery);// å»ºç«‹å…¬é‘°è¦å‰‡
		key = kf.generatePublic(keySpec);
	} else {
		final PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(keyBinery);// å»ºç«‹ç§é‘°è¦å‰‡
		key = kf.generatePrivate(keySpec);
	}
	return key;
}
```

### æ•¸å­—è­‰æ›¸
- æ•¸å­—è­‰æ›¸ç›¸ç•¶æ–¼ç¬¬ä¸‰æ–¹èº«åˆ†èªè­‰ï¼Œé¡ä¼¼æ–¼é›…æ€ã€æ‰˜ç¦è­‰æ›¸ï¼Œåƒè€ƒï¼š
	1. æ•´å€‹æµç¨‹å¯åƒè€ƒ[[ğŸŒç¶²è·¯æ¶æ§‹_05_HTTPSå”è­°]]
	2. åƒè€ƒï¼š[æ•¸å­—è­‰æ›¸åœ–è§£æµç¨‹](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/723427/)
		![[å¯†ç¢¼å­¸_07_æ•¸å­—è­‰æ›¸.png]]
